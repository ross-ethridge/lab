<div class="max-w-3xl mx-auto mt-8 bg-zinc-800 rounded-2xl shadow-xl overflow-hidden border border-zinc-700">

  <!-- Header -->
  <header class="bg-zinc-800 px-6 py-4 border-b border-zinc-700 flex items-center gap-3">
    <div class="bg-gradient-to-br from-blue-400 to-blue-700 text-white w-12 h-12 rounded-full flex items-center justify-center shadow-sm">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-10 h-10">
        <path d="M8.5 9Q9 4 9.5 4.5Q10.5 6 10.5 7.5Q11 4 12 3.5Q13 4 13.5 7.5Q13.5 6 14.5 4.5Q15 4 15.5 9Q14 8.5 12 8.5Q10 8.5 8.5 9Z"/>
        <circle cx="12" cy="10.2" r="3.3"/>
        <path d="M11 13.5h2v1.5h-2z"/>
        <path d="M7 15C8.5 14.3 10.5 14 12 14s3.5.3 5 1v3H7v-3z"/>
      </svg>
    </div>
    <h2 class="m-0 text-xl font-semibold text-zinc-100">Image Generator</h2>
    <%= link_to "â† Back to Chat", chats_path, class: "ml-auto text-sm text-blue-400 hover:text-blue-300" %>
  </header>

  <div class="p-8 bg-zinc-900">
    <% if flash[:error] %>
      <div class="mb-6 px-4 py-3 bg-red-900/40 border border-red-700 text-red-400 rounded-lg text-sm">
        <%= flash[:error] %>
      </div>
    <% end %>

    <p class="text-zinc-400 text-sm mb-6">Describe the image you want. It will be generated by Stable Diffusion and displayed below.</p>

    <%= form_with url: images_path, local: true, data: { turbo: false } do |f| %>
      <div class="flex flex-col gap-4">
        <%= f.text_area :prompt,
              placeholder: "A photorealistic golden retriever sitting in a field of sunflowers at sunset...",
              rows: 4,
              class: "w-full bg-zinc-700 border border-zinc-600 rounded-xl px-4 py-3 text-zinc-100 placeholder-zinc-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 resize-none",
              required: true,
              autofocus: true %>

        <%= f.submit "Generate & Download",
              class: "self-end bg-blue-600 hover:bg-blue-700 text-white font-semibold px-6 py-3 rounded-full transition-colors cursor-pointer" %>
      </div>
    <% end %>

    <% if @image_data %>
      <div class="mt-6">
        <img src="data:image/png;base64,<%= @image_data %>" class="w-full rounded-xl shadow-md" alt="<%= @prompt %>" />
        <a href="data:image/png;base64,<%= @image_data %>" download="<%= @filename %>" class="mt-3 inline-block text-sm text-blue-400 hover:text-blue-300">Download image</a>
      </div>
    <% end %>
  </div>
</div>
